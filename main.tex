\documentclass[a4paper,12pt,twoside]{article}
\usepackage{xcolor}
\definecolor{verde}{rgb}{0,0.5,0}
\definecolor{jpurple}{rgb}{0.5,0,0.35}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{float}
\usepackage[brazilian]{babel}
\usepackage{indentfirst}
\usepackage{steinmetz}
\usepackage{multicol}
\usepackage[left=1cm, right=1cm, top=1cm]{geometry}
\setlength\parindent{1cm}
\usepackage{mathrsfs, amsmath}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{lipsum}
\usepackage{natbib}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{url}


% Definindo novas cores
\definecolor{verde}{rgb}{0.25,0.5,0.35}
\definecolor{jpurple}{rgb}{0.5,0,0.35}
% Configurando layout para mostrar codigos Python

\lstset{
  language=Python,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{jpurple}\bfseries,
  stringstyle=\color{red},
  commentstyle=\color{verde},
  morecomment=[s][\color{blue}]{/**}{*/},
  extendedchars=true,
  showspaces=false,
  showstringspaces=false,
  numbers=left,
  numberstyle=\tiny,
  breaklines=true,
  backgroundcolor=\color{cyan!10},
  breakautoindent=true,
  captionpos=b,
  xleftmargin=0pt,
  tabsize=4,
  escapeinside={*!}{!*}
}



\headheight = 10pt

\setcounter{section}{-1}



\date{}

\begin{document}

% capa
\begin{titlepage} %iniciando a "capa"
\begin{center} %centralizar o texto abaixo
{\large Universidade Federal do Rio de Janeiro}\\[0.2cm] %0,2cm é a distância entre o texto dessa linha e o texto da próxima
{\large Escola Politécnica}\\[0.2cm] % o comando \\ "manda" o texto ir para próxima linha
{\large Departamento de Engenharia Eletrônica e de Computação}\\[0.2cm]
{\large Engenharia Eletrônica e de Computação}\\[0.2cm]
{\large Álgebra Linear 2}\\[5.1cm]
{\bf \huge TRABALHO DE}\\ % o comando \bf deixa o texto entre chaves em negrito. O comando \huge deixa o texto enorme
{\bf \huge ÁLGEBRA LINEAR 2}\\[5.1cm] 
\end{center} %término do comando centralizar
{\large Aluna: Karen dos Anjos Arcoverde}\\[0.7cm] % o comando \large deixa o texto grande
{\large Professor: Marcello Luiz Rodrigues de Campos}\\[5.1cm]
\begin{center}
{\large Rio de Janeiro}\\[0.2cm]
{\large 2021}
\end{center}
\end{titlepage} %término da "capa"


\renewcommand{\contentsname}{Sumário}

\tableofcontents
\clearpage





\section{Introdução}
\subsection{Conteúdo}
    O relatório contém os resultados encontrados para cada questão passada pelo professor e o código final em linguagem Python.
\subsection{Software e linguagem}
    O software usado para programação foi o Spyder e a linguagem foi o Python 3.8.
\subsection{Bibliotecas}
As bibliotecas utilizadas para construir o código em Python foram:
\begin{itemize}
   \item Numpy
   \item Scipy
 \end{itemize}
 \subsection{Base de dados}
 O  conjunto de dados "Iris" selecionado para o trabalho foi:
 \begin{table}[H]
\begin{tabular}{|c|c|c|} \hline
\textbf{ESPÉCIES} & DE & PARA \\\hline
\textbf{Iris-setosa}  & 25 & 39 \\\hline
\textbf{Iris-versicolor} & 75 & 89  \\\hline
\textbf{Iris-virginica} & 125 & 139 \\\hline

 
\end{tabular}
\label{tabela2}
\centering
\caption{Base de dados "Iris" selecionada}
\label {tabela2}
\end{table}

\section{Observações}
A variável $y$ da coluna PetalWidthCm foi escrita em função das outras variáveis $x_{1}$,$x_{2}$,$x_{3}$ das colunas SepalLengthCm,SepalWidthCm,PetalLengthCm, respectivamente. De forma que 
$y= a\cdot x_{1} +b\cdot x_{2}+c\cdot x_{3}$ sem o termo independente. Com o termo independente: $y= a\cdot x_{1} +b\cdot x_{2}+c\cdot x_{3} +k$.

    Além disso, a equação normal é: $x^{T}\cdot x\cdot w=x^{T}\cdot y$, onde $w$ é o vetor de coeficientes, o vetor y é a coluna PetalWidthCm e a matriz $x$ é as colunas SepalLengthCm,SepalWidthCm,PetalLengthCm (se for com o termo independente, possui uma coluna a mais que só contém valores 1).


\section{Questão 1}
\subsection{Resultados}
\subsubsection{Iris-Setosa}
\begin{lstlisting}
Iris-Setosa

SEM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3
[a b c] = [ 0.07455282 -0.06602361  0.03673264]

COM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3 + k
[a b c k] = [ 0.13497209 -0.07886596  0.10365958 -0.36144997]
\end{lstlisting}

\subsubsection{Iris-Versicolor}
\begin{lstlisting}
Iris-Versicolor

SEM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3
[a b c] = [-0.14382683  0.17051618  0.40397714]

COM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3 + k
[a b c k] = [-0.06826027  0.24149193  0.39877688 -0.63863516]
\end{lstlisting}

\subsubsection{Iris-Virginica}
\begin{lstlisting}
Iris-Virginica

SEM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3
[a b c] = [-0.11329721  0.3990124   0.25976859]

COM O TERMO INDEPENDENTE: 
y = a*x1 + b*x2 + c*x3 + k
[a b c k] = [-0.11686468  0.35346044  0.22325742  0.36734017]
\end{lstlisting}

\section{Questão 2}
\subsection{Resultados}
\subsubsection {Iris-Setosa}


\begin{lstlisting}
Iris-Setosa

R = V*!$\Lambda$!*V^(T)

SEM O TERMO INDEPENDENTE: 
V =  [[-0.80618188 -0.45661854  0.37625828]
 [-0.54157827  0.31342349 -0.78003762]
 [-0.23825146  0.8326255   0.49997102]]

*!$\Lambda$!* =  [[5.86392634e+02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 5.29776824e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 7.47589571e-01]]

V^T =  [[-0.80618188 -0.54157827 -0.23825146]
 [-0.45661854  0.31342349  0.8326255 ]
 [ 0.37625828 -0.78003762  0.49997102]]


COM O TERMO INDEPENDENTE: 
V =  [[-0.79610972  0.1628056  -0.47792329 -0.33360603]
 [-0.53478061 -0.03864172  0.33762985  0.77364243]
 [-0.23529777  0.18572124  0.80860497 -0.50626137]
 [-0.15765144 -0.96825037  0.06126507 -0.18407563]]

*!$\Lambda$!* =  [[6.01336860e+02 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 2.79352229e-02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.31947766e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 7.73257486e-01]]

V^T =  [[-0.79610972 -0.53478061 -0.23529777 -0.15765144]
 [ 0.1628056  -0.03864172  0.18572124 -0.96825037]
 [-0.47792329  0.33762985  0.80860497  0.06126507]
 [-0.33360603  0.77364243 -0.50626137 -0.18407563]]

\end{lstlisting}

\subsubsection{Iris-Versicolor}

\begin{lstlisting}
Iris-Versicolor

R = V*!$\Lambda$!*V^(T)

SEM O TERMO INDEPENDENTE: 
V =  [[ 0.76039163  0.64759888 -0.0491961 ]
 [ 0.35223975 -0.47485674 -0.80649751]
 [ 0.54564799 -0.59592513  0.58918716]]

*!$\Lambda$!* =  [[9.59570396e+02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.33162776e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 9.57976568e-01]]

V^T =  [[ 0.76039163  0.35223975  0.54564799]
 [ 0.64759888 -0.47485674 -0.59592513]
 [-0.0491961  -0.80649751  0.58918716]]


COM O TERMO INDEPENDENTE: 
V =  [[-0.7545525   0.11812875  0.64474223  0.03167953]
 [-0.34954066  0.11526607 -0.46962259  0.80248968]
 [-0.54144512 -0.01367345 -0.60234554 -0.58637025]
 [-0.1237297  -0.98619084  0.030691    0.1057197 ]]

*!$\Lambda$!* =  [[9.74487597e+02 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 7.14132919e-02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 1.33280153e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 9.68188359e-01]]

V^T =  [[-0.7545525  -0.34954066 -0.54144512 -0.1237297 ]
 [ 0.11812875  0.11526607 -0.01367345 -0.98619084]
 [ 0.64474223 -0.46962259 -0.60234554  0.030691  ]
 [ 0.03167953  0.80248968 -0.58637025  0.1057197 ]]
\end{lstlisting}

\subsubsection{Iris-Virginica}

\begin{lstlisting}
Iris-Virginica

R = V*!$\Lambda$!*V^(T)

SEM O TERMO INDEPENDENTE: 
V =  [[-0.72592866 -0.63483621  0.2645951 ]
 [-0.32772296 -0.01894783 -0.94458385]
 [-0.60466953  0.77241438  0.19429563]]

*!$\Lambda$!* =  [[1.28249881e+03 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 5.79253032e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 1.07193335e+00]]

V^T =  [[-0.72592866 -0.32772296 -0.60466953]
 [-0.63483621 -0.01894783  0.77241438]
 [ 0.2645951  -0.94458385  0.19429563]]


COM O TERMO INDEPENDENTE: 
V =  [[-7.21743001e-01 -2.76297507e-01  6.34623278e-01 -1.50933108e-04]
 [-3.25843186e-01  9.35769444e-01  3.68031853e-02 -1.29642937e-01]
 [-6.01187515e-01 -1.93722166e-01 -7.68083597e-01 -1.05322749e-01]
 [-1.07176625e-01  1.02308151e-01 -7.71129602e-02  9.85951218e-01]]

*!$\Lambda$!* =  [[1.29740071e+03 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.08243546e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.82311582e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 8.45463191e-02]]

V^T =  [[-7.21743001e-01 -3.25843186e-01 -6.01187515e-01 -1.07176625e-01]
 [-2.76297507e-01  9.35769444e-01 -1.93722166e-01  1.02308151e-01]
 [ 6.34623278e-01  3.68031853e-02 -7.68083597e-01 -7.71129602e-02]
 [-1.50933108e-04 -1.29642937e-01 -1.05322749e-01  9.85951218e-01]]
\end{lstlisting}

\section{Questão 3}
\subsection{Resultados}
\subsubsection{Iris-Setosa}
\begin{lstlisting}
Iris-Setosa

R = U*!$\Sigma$!*V^(T)

SEM O TERMO INDEPENDENTE: 
U =  [[-0.80618188  0.37625828 -0.45661854]
 [-0.54157827 -0.78003762  0.31342349]
 [-0.23825146  0.49997102  0.8326255 ]]

*!$\Sigma$!* =  [[5.86392634e+02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 7.47589571e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.29776824e-01]]

V^T =  [[-0.80618188 -0.54157827 -0.23825146]
 [ 0.37625828 -0.78003762  0.49997102]
 [-0.45661854  0.31342349  0.8326255 ]]


COM O TERMO INDEPENDENTE: 
U =  [[-0.79610972  0.33360603  0.47792329 -0.1628056 ]
 [-0.53478061 -0.77364243 -0.33762985  0.03864172]
 [-0.23529777  0.50626137 -0.80860497 -0.18572124]
 [-0.15765144  0.18407563 -0.06126507  0.96825037]]

*!$\Sigma$!* =  [[6.01336860e+02 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 7.73257486e-01 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.31947766e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 2.79352229e-02]]

V^T =  [[-0.79610972 -0.53478061 -0.23529777 -0.15765144]
 [ 0.33360603 -0.77364243  0.50626137  0.18407563]
 [ 0.47792329 -0.33762985 -0.80860497 -0.06126507]
 [-0.1628056   0.03864172 -0.18572124  0.96825037]]
\end{lstlisting}

\subsubsection{Iris-Versicolor}
\begin{lstlisting}
Iris-Versicolor

R = U*!$\Sigma$!*V^(T)

SEM O TERMO INDEPENDENTE: 
U =  [[-0.76039163  0.64759888 -0.0491961 ]
 [-0.35223975 -0.47485674 -0.80649751]
 [-0.54564799 -0.59592513  0.58918716]]

*!$\Sigma$!* =  [[9.59570396e+02 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.33162776e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 9.57976568e-01]]

V^T =  [[-0.76039163 -0.35223975 -0.54564799]
 [ 0.64759888 -0.47485674 -0.59592513]
 [-0.0491961  -0.80649751  0.58918716]]


COM O TERMO INDEPENDENTE: 
U =  [[-0.7545525   0.64474223  0.03167953 -0.11812875]
 [-0.34954066 -0.46962259  0.80248968 -0.11526607]
 [-0.54144512 -0.60234554 -0.58637025  0.01367345]
 [-0.1237297   0.030691    0.1057197   0.98619084]]

*!$\Sigma$!* =  [[9.74487597e+02 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.33280153e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 9.68188359e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 7.14132919e-02]]

V^T =  [[-0.7545525  -0.34954066 -0.54144512 -0.1237297 ]
 [ 0.64474223 -0.46962259 -0.60234554  0.030691  ]
 [ 0.03167953  0.80248968 -0.58637025  0.1057197 ]
 [-0.11812875 -0.11526607  0.01367345  0.98619084]]
\end{lstlisting}

\subsubsection{Iris-Virginica}
\begin{lstlisting}
Iris-Virginica

R = U*!$\Sigma$!*V^(T)

SEM O TERMO INDEPENDENTE: 
U =  [[-0.72592866  0.2645951  -0.63483621]
 [-0.32772296 -0.94458385 -0.01894783]
 [-0.60466953  0.19429563  0.77241438]]

*!$\Sigma$!* =  [[1.28249881e+03 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.07193335e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.79253032e-01]]

V^T =  [[-0.72592866 -0.32772296 -0.60466953]
 [ 0.2645951  -0.94458385  0.19429563]
 [-0.63483621 -0.01894783  0.77241438]]


COM O TERMO INDEPENDENTE: 
U =  [[-7.21743001e-01  2.76297507e-01  6.34623278e-01 -1.50933108e-04]
 [-3.25843186e-01 -9.35769444e-01  3.68031853e-02 -1.29642937e-01]
 [-6.01187515e-01  1.93722166e-01 -7.68083597e-01 -1.05322749e-01]
 [-1.07176625e-01 -1.02308151e-01 -7.71129602e-02  9.85951218e-01]]

*!$\Sigma$!* =  [[1.29740071e+03 0.00000000e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 1.08243546e+00 0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 5.82311582e-01 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 8.45463191e-02]]

V^T =  [[-7.21743001e-01 -3.25843186e-01 -6.01187515e-01 -1.07176625e-01]
 [ 2.76297507e-01 -9.35769444e-01  1.93722166e-01 -1.02308151e-01]
 [ 6.34623278e-01  3.68031853e-02 -7.68083597e-01 -7.71129602e-02]
 [-1.50933108e-04 -1.29642937e-01 -1.05322749e-01  9.85951218e-01]]
\end{lstlisting}

\section{Questão 4}
\subsection{Resultados}
\begin{lstlisting}
SEM O TERMO INDEPENDENTE: 
A =  Iris-Versicolor
B =  Iris-Setosa
C =  Iris-Setosa
D =  Iris-Versicolor
E =  Iris-Virginica

COM O TERMO INDEPENDENTE: 
A =  Iris-Versicolor
B =  Iris-Setosa
C =  Iris-Setosa
D =  Iris-Versicolor
E =  Iris-Virginica
\end{lstlisting}

\section{Código}
\begin{lstlisting}
# Programa codigo.py
# Autora: Karen dos Anjos Arcoverde
# Data: 06/02/2021
#


import numpy as np
from scipy import linalg
from scipy.linalg import diagsvd
import sys



############################# Funcoes #############################
def pegarDados(tipo_iris): 
    
    # tipo_iris = 1 Setosa  , tipo_iris = 2  Versicolor, 
    # tipo_iris = 3 Virginica
    dados = []
    IDs = []
    
    Setosa = range(25,39+1)
    Versicolor = range(75,89+1)
    Virginica = range (125,139+1)
    
    arquivo= open("dados_13.csv",'r')
    arquivo.readline() # ignora a primeira linha
    
    if (tipo_iris == 1):
        IDs = Setosa
    if (tipo_iris == 2):
        IDs = Versicolor
    if (tipo_iris == 3):
        IDs = Virginica
        
    for i in range(1,46): # percorre todo o banco de dados 1-45
        linha = (arquivo.readline()).split(',') #separa os dados por virgula
    
        
        if  (int(linha[0]) in IDs):# percorre os ids selecionados
            linha.pop(0) # retira o ID dos dados
            linha.pop(-1) # retira a especie dos dados
            for j in range(4): #para cada dado 
                linha[j] = float(linha[j]) #transforma em numero
                
            dados.append(linha) #adiciona na lista de dados
            
    arquivo.close()
    return dados

# ----------------------------------------------------------
def construir_equacao_normal (dados):
    
    #equacao normal - minimos quadrados:
    # (x^T).x.w = (x^T).y
    #(x_transposta).x.w =(x_transposta).y
    # R.w = p
    # R = (x^T).x
    # p = (x^T).y
    
    ###### sem termo independente #####
    # y = a*x1 +b*x2 +c*x3
    x = []
    y = []
    
    #achar (x^T) e x
    # x - colunas SepalLengthCm,SepalWidthCm,PetalLengthCm
    x = np.array(dados) 
    x = np.delete(x.reshape(15,4),3,1) #deleta a ultima coluna de x
    x_transposta = np.transpose(x) #faz a transposta de x: (x^T)
    
    #achar R
    R = np.dot(x_transposta,x) #multiplica (x^T) por x
    
    #achar y - coluna PetalWidthCm
    y = np.array(dados) 
    y = np.delete(y.reshape(15,4),0,1) #deleta a primeira coluna de y
    y = np.delete(y.reshape(15,3),0,1) #deleta a segunda coluna de y
    y = np.delete(y.reshape(15,2),0,1) #deleta a terceira coluna de y

    #achar p 
    p = np.dot(x_transposta,y) 
    
    ###### com termo independente #####
    # y = a*x1 +b*x2 +c*x3 +k
     
    for i in range (0,15):
        dados[i][3] = 1
    
    #achar (x^T) e x
    x = np.array(dados) 
    x_transposta = np.transpose(x) #faz a transposta de x: (x^T)
    #achar R
    R1= np.dot(x_transposta,x) #multiplica (x^T) por x
    #achar p 
    p1 = np.dot(x_transposta,y) 
    
    return R,p,R1,p1

# ----------------------------------------------------------
def PLU(R,p):
    indice_coluna = 0 
    indice_linha = 1
    indice_L_1s = 0
    tamanho_R = len(R)
    
    while (indice_coluna < tamanho_R):
        #constroi a matriz L, triangular inferior
        if (R[indice_coluna][indice_coluna] != 0):
            L = np.zeros((tamanho_R, tamanho_R))
            
            indice_coluna_aux = indice_coluna + 1
            while (indice_coluna_aux < tamanho_R):
                L[indice_coluna_aux][indice_coluna] = - R[indice_coluna_aux][indice_coluna]/R[indice_coluna][indice_coluna]
                indice_linha += 1
                indice_coluna_aux += 1
            
            while (indice_L_1s < tamanho_R):
                L[indice_L_1s][indice_L_1s] = 1
                indice_L_1s += 1
            
            indice_L_1s = 0
            indice_linha = 1
                 
            #multiplica a matriz R por L
            R = np.dot (L,R)
            p = np.dot (L,p)
        
                
        #se o pivo for zero, necessario multiplicar por uma matriz P de permutacao
        if (R[indice_coluna][indice_coluna] == 0):
            P = np.zeros((tamanho_R, tamanho_R))
            P[indice_coluna][indice_coluna + 1] = 1
            P[indice_coluna + 1][indice_coluna] = 1
            
            i = 0
            j = 0
            guarda_1 = False
            while (i < tamanho_R):
                while (j < tamanho_R):
                    if (P[i][j] == 1):
                        guarda_1 = True
                        j += 1
                if (guarda_1 == False):
                    P[i][i] = 1
                i += 1
            
            R = np.dot(P,R)
            p = np.dot (P,p)
       
        indice_coluna += 1 
    
    #backsubstitution
    w = np.linalg.solve(R, p)
      
    return w
           
# ----------------------------------------------------------
def decomposicao_espectral(R):
    
    # R = VDV^(T)
    #determinando autovalores e autovetores
    autovalores, autovetores = np.linalg.eig(R) 
    # matriz diagonal de autovalores
    matrizDiagonal = np.diag(autovalores) 
      
    return  autovetores, matrizDiagonal

# ----------------------------------------------------------
def estimar_amostras(amostra, w_setosa,w_versicolor,w_virginica,c_independente):
    
   lista_erros = []
   estimativa = ""
   indice = 0
   amostra_x = []
   indice_erros_modulo = 0
   
   while (indice < 3):
       amostra_x.append (amostra[indice])
       indice += 1
       
   if (c_independente == True):
       amostra_x.append(1)
      
   amostra_x = np.array(amostra_x)
   
   #produto interno <x,y> = (x^T).y
   
   estimativa_setosa = np.dot(amostra_x,w_setosa)
   estimativa_versicolor = np.dot(amostra_x,w_versicolor)
   estimativa_virginica = np.dot(amostra_x,w_virginica)
   
   erro_setosa = estimativa_setosa[0] - amostra[3]
   lista_erros.append(erro_setosa)
   
   erro_versicolor = estimativa_versicolor[0] - amostra[3]
   lista_erros.append(erro_versicolor)
   
   erro_virginica = estimativa_virginica[0] - amostra[3]
   lista_erros.append(erro_virginica)
   
   while (indice_erros_modulo < len(lista_erros)):
       lista_erros [indice_erros_modulo] = abs(lista_erros[indice_erros_modulo])
       indice_erros_modulo += 1
   
   if (min(lista_erros) == abs(erro_setosa)):
       estimativa = "Iris-Setosa"
       
       return estimativa
   
   if (min(lista_erros) == abs(erro_versicolor)):
       estimativa = "Iris-Versicolor"
       
       return estimativa
   
   if (min(lista_erros) == abs(erro_virginica)):
       estimativa = "Iris-Virginica"
       
       return estimativa
    
################### Programa Principal ###################
def menu():
    resultado = 0
    tipo_iris = 0
    coeficientes_sem_aux = []
    coeficientes_com_aux = []
    indice = 0
    
    
    while (resultado != 5):    
        print()
        print('##################### MENU PRINCIPAL ##############################')
        print("Digite somente o numero da questao que voce deseja ver o resultado: ")
        print("1 = Questao 1")
        print("2 = Questao 2")
        print("3 = Questao 3")
        print("4 = Questao 4")
        print("5 = SAIR")
        print('###################################################################')
        print()
        
        resultado = int(input())
        
        if (resultado == 5):
            sys.exit(0)
    
        if (resultado == 1):
            
            while (tipo_iris != 4):
                print('##################### MENU IRIS #########################')
                print("Digite qual especie voce deseja fazer a regressao linear: ")
                print("1 = Iris-Setosa")
                print("2 = Iris-Versicolor")
                print("3 = Iris Virginica")
                print("4 = VOLTAR AO MENU PRINCIPAL")
                print('#########################################################')
                print()
             
                tipo_iris = int(input())
                
                if (tipo_iris == 4):
                   menu()
                   
                else:
                    dados = pegarDados (tipo_iris)
                    R,p,R1,p1 = construir_equacao_normal(dados)
                    w = PLU(R,p)
                    w1 = PLU(R1,p1)
                              
                    print()
                    if  (tipo_iris == 1):
                        print("Iris-Setosa\n")
                    elif (tipo_iris == 2):
                        print("Iris-Versicolor\n")
                    elif (tipo_iris == 3):
                        print("Iris-Virginica\n")
                        
                    print("SEM O TERMO INDEPENDENTE: ")
                    print("y = a*x1 + b*x2 + c*x3")
                    print("[a b c] = ",end="")
                    
                    
                    while (indice < len(w)):
                        coeficientes_sem_aux.append(w[indice][0])
                        coeficientes_sem = np.array(coeficientes_sem_aux)
                        indice += 1
                    
                    print(coeficientes_sem)
                    coeficientes_sem_aux = []
                    
                        
                    print()
                    
                    print("COM O TERMO INDEPENDENTE: ")
                    print("y = a*x1 + b*x2 + c*x3 + k")
                    print("[a b c k] = ",end="")
                    
                    indice = 0
                    while (indice < len(w1)):
                        coeficientes_com_aux.append(w1[indice][0])
                        coeficientes_com = np.array(coeficientes_com_aux)
                        indice += 1
                    
                    print(coeficientes_com)
                    coeficientes_com_aux = []  
                    indice = 0
                   
                    print()
    
        if (resultado == 2):
            
            while (tipo_iris != 4):
                print('##################### MENU IRIS ###############################')
                print("Digite qual especie voce deseja fazer a decomposicao espectral: ")
                print("1 = Iris-Setosa")
                print("2 = Iris-Versicolor")
                print("3 = Iris Virginica")
                print("4 = VOLTAR AO MENU PRINCIPAL")
                print('###########################################################')
                print()
             
             
                tipo_iris = int(input())
                
                if (tipo_iris == 4):
                   menu()
                   
                else:
                    dados = pegarDados (tipo_iris)
                    R,p,R1,p1 = construir_equacao_normal(dados)
                    autovetores, matrizDiagonal = decomposicao_espectral(R)
                    autovetores1, matrizDiagonal1 = decomposicao_espectral(R1)
                    
                    if  (tipo_iris == 1):
                        print("Iris-Setosa\n")
                    elif (tipo_iris == 2):
                        print("Iris-Versicolor\n")
                    elif (tipo_iris == 3):
                        print("Iris-Virginica\n")
                    
                    print("R = V\u039BV^(T)")
                    print()
                    
                    print("SEM O TERMO INDEPENDENTE: ")
                    print("V = ",autovetores)
                    print()
                    print('\u039B = ',matrizDiagonal)
                    print()
                    print("V^T = ",np.transpose(autovetores))
                    
                    print()
                    print()
                    
                    print("COM O TERMO INDEPENDENTE: ")
                    print("V = ", autovetores1)
                    print()
                    print('\u039B = ', matrizDiagonal1)
                    print()
                    print("V^T = ", np.transpose(autovetores1))
                    
                    print()
        
        if (resultado == 3):
             
           while (tipo_iris != 4):
               print('##################### MENU IRIS #############')
               print("Digite qual especie voce deseja fazer o SVD: ")
               print("1 = Iris-Setosa")
               print("2 = Iris-Versicolor")
               print("3 = Iris Virginica")
               print("4 = VOLTAR AO MENU PRINCIPAL")
               print('#############################################')
               print()
             
               tipo_iris = int(input())
              
               if (tipo_iris == 4):
                   menu()
               
               else:
                
                   dados = pegarDados (tipo_iris)
                   R,p,R1,p1 = construir_equacao_normal(dados)
                   U, s, VT = linalg.svd(R)
                   U1, s1, VT1 = linalg.svd(R1)
                   
                   if  (tipo_iris == 1):
                        print("Iris-Setosa\n")
                   elif (tipo_iris == 2):
                        print("Iris-Versicolor\n")
                   elif (tipo_iris == 3):
                        print("Iris-Virginica\n")
                        
                   print("R = U\u03A3V^(T)")
                   print()
                   
                   print("SEM O TERMO INDEPENDENTE: ")
                   print("U = ", U)
                   print()
                   print('\u03A3 = ', diagsvd(s, R.shape[0], R.shape[1]))
                   print()
                   print("V^T = ", VT)
                   print()
                   print()
                    
                   print("COM O TERMO INDEPENDENTE: ")
                   print("U = ", U1)
                   print()
                   print('\u03A3 = ', diagsvd(s1, R1.shape[0], R1.shape[1]))
                   print()
                   print("V^T = ", VT1)
                   
                   print()
                   
               
                
        if (resultado == 4):
            A = [5.0,2.3,3.3,1.0]
            B = [4.6,3.2,1.4,0.2]
            C = [5.0,3.3,1.4,0.2]
            D = [6.1,3.0,4.6,1.4]
            E = [5.9,3.0,5.1,1.8]
            
            print("SEM O TERMO INDEPENDENTE: ")
            dados = pegarDados (1)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w_setosa = PLU(R,p)
            
            dados = pegarDados (2)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w_versicolor = PLU(R,p)
        
            dados = pegarDados (3)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w_virginica = PLU(R,p)
            
            c_independente = False
            estimativa = estimar_amostras(A,w_setosa,w_versicolor,w_virginica,c_independente)
            print("A = ", estimativa)
            estimativa = estimar_amostras(B,w_setosa,w_versicolor,w_virginica,c_independente)
            print("B = ", estimativa)
            estimativa = estimar_amostras(C,w_setosa,w_versicolor,w_virginica,c_independente)
            print("C = ", estimativa)
            estimativa = estimar_amostras(D,w_setosa,w_versicolor,w_virginica,c_independente)
            print("D = ", estimativa)
            estimativa = estimar_amostras(E,w_setosa,w_versicolor,w_virginica,c_independente)
            print("E = ", estimativa)
            
            print()
            print("COM O TERMO INDEPENDENTE: ")
            dados = pegarDados (1)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w1_setosa = PLU(R1,p1)
            
            dados = pegarDados (2)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w1_versicolor = PLU(R1,p1)
            
            dados = pegarDados (3)
            R,p,R1,p1 = construir_equacao_normal(dados)
            w1_virginica = PLU(R1,p1)
            
            c_independente = True
            estimativa1 = estimar_amostras(A,w1_setosa,w1_versicolor,w1_virginica,c_independente)
            print("A = ", estimativa1)
            estimativa1 = estimar_amostras(B,w1_setosa,w1_versicolor,w1_virginica,c_independente)
            print("B = ", estimativa1)
            estimativa1 = estimar_amostras(C,w1_setosa,w1_versicolor,w1_virginica,c_independente)
            print("C = ", estimativa1)
            estimativa1 = estimar_amostras(D,w1_setosa,w1_versicolor,w1_virginica,c_independente)
            print("D = ", estimativa1)
            estimativa1 = estimar_amostras(E,w1_setosa,w1_versicolor,w1_virginica,c_independente)
            print("E = ", estimativa1)
            
            menu()
                       
######## chamada ao menu
menu()
\end{lstlisting}



\section{Bibliografia}
\begin{itemize}
   \item \url{https://algebralinearufcg.github.io/jup-not/prog02-learning-numpy.html}
   \item \url{https://machinelearningmastery.com/singular-value-decomposition-for-machine-learning/}
   \item \url{https://pt.coredump.biz/questions/34007632/how-to-remove-a-column-in-a-numpy-array}
   \item \url{https://pythonforundergradengineers.com/unicode-characters-in-python.html}
   \item \url{https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.svd.html}
   \item \url{https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.diagsvd.html#scipy.linalg.diagsvd}
   \item \url{https://www.geeksforgeeks.org/python-exit-commands-quit-exit-sys-exit-and-os-_exit/}
 \end{itemize}

\end{document}
